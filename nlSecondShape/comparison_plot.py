import matplotlib.pyplot as plt

# norm of deformations
ex1_int_def = [0.00742605656784481, 0.005766874372846269, 0.0036451291234747534, 0.0029970367257909536,
           0.0016573035507850544, 0.0015681536773265203, 0.0008009455955681926, 0.0008697979403404908,
           0.0005251959900182794, 0.0005626202283664119, 0.00042763993620272385, 0.0004142542439416468,
           0.00035088152360053916, 0.00032032085119782427, 0.00028052044240264715, 0.00024972282805077716,
           0.00021982919385773154, 0.00019383489360652825, 0.0001703224837749751, 0.0001496356690870125,
           0.00013126151759142743, 0.00011497962815532953, 0.00010057353196654155, 8.783300436855953e-05,
           7.661910537704186e-05, 6.673051706139153e-05, 5.800727445266094e-05, 5.043658914184858e-05,
           4.3857816392811335e-05]

ex2_int_def = [0.012908226979755737, 0.0012708995080294601, 0.0010771956261990084, 0.0009604232372138829,
               0.0008319164151463915, 0.0007356397768876131, 0.0006408924742763333, 0.0005643977736532871,
               0.0004934525422281723, 0.00043309246623668006, 0.00037929996492909213, 0.000332094292862617,
               0.00029115668026741075, 0.0002544459509870551, 0.0002230733077421931, 0.0001946225626706249,
               0.00017054466245117599, 0.00014854328906397637, 0.00013007901767339306, 0.000113223469391227,
               9.915796536335155e-05, 8.632927202710212e-05, 7.558851496208186e-05, 6.582399227054363e-05,
               5.7625877974331933e-05, 5.020745167614725e-05, 4.3910937948983894e-05]

ex1_sing_def = [0.002068590324338298, 0.0010684507899107437, 0.0009918816421401713, 0.0009084774374548242,
                0.0008354520591099344, 0.000769803961044937, 0.000710420372408959, 0.0006564642432547295,
                0.00060721005569112, 0.00056209199749636, 0.0005206403990960835, 0.00048249783445371703,
                0.0004473484722090096, 0.0004149227478634682, 0.00038493771012027727, 0.00035720262728190544,
                0.0003315104980010169, 0.000307689112656549, 0.000285642702571361, 0.0002652450837237854,
                0.00024636362747303126, 0.00022886745511325253, 0.00021265341675283364, 0.0001976191108958527,
                0.0001836882323011607, 0.000170767216951379, 0.00015879520866556954, 0.00014768578362516733,
                0.0001373829092299462, 0.00012781821528087996, 0.00011893341157367959, 0.00011068183749127382,
                0.0001030166032705263, 9.589271186642018e-05, 8.926996939164053e-05, 8.310912606867894e-05,
                7.738240188925899e-05, 7.205868324672498e-05, 6.707837445114141e-05, 6.247097468829899e-05,
                5.819180762865839e-05, 5.415858976329122e-05, 5.0440182443783556e-05, 4.6980720922050546e-05]

ex2_sing_def = [0.018228370281950953, 0.0046132098313781435, 0.0005922483044996263, 0.0005088259967852976,
           0.00042545834568848145, 0.00035817506976546095, 0.0003029930100421635, 0.00025771254360191934,
           0.00022051853173750828, 0.00018994333293236924, 0.00016469903290622208, 0.000143791173250224,
           0.00012637491298156882, 0.00011177980199440195, 9.94638520661648e-05, 8.900844325929296e-05,
           8.005569545763742e-05, 7.23288554364925e-05, 6.561397991228903e-05, 5.971356773362695e-05,
           5.4505416434368625e-05, 4.988049695706572e-05]

# objective functional values
ex1_int_obj = [0.006046644578868349, 0.004595657573263593, 0.004180583230765446, 0.0037960495981585393,
           0.0036596146856457037, 0.0035288184218611866, 0.0034611121575517335, 0.003395047942109633,
           0.0033527851169049524, 0.003311464387824063, 0.003281763870573608, 0.003254199699919211,
           0.003232894243746329, 0.0032144947679432836, 0.003200112809404604, 0.003188329129810078,
           0.0031791175108133304, 0.003171830196492845, 0.0031662242981356716, 0.003161936350511128,
           0.0031587126728128876, 0.0031563272562800154, 0.003154593612699952, 0.0031533666772841163,
           0.0031525302210642, 0.0031519918430932673, 0.0031516867788697533, 0.003151539376790559,
           0.0031515133702252115, 0.0031515658609799747]

ex2_int_obj = [0.012927541385924137, 0.0031791575625108267, 0.0031833403966177467, 0.003166805719100796,
               0.0031720447671087083, 0.0031606235172734727, 0.003165369226020593, 0.003157297163606201,
               0.003161364399822882, 0.0031555439791148363, 0.003158913356776404, 0.003154658280963989,
               0.0031573907954485863, 0.0031542489064361953, 0.00315642792526224, 0.0031540916535468025,
               0.003155809485355178, 0.0031540638804495925, 0.003155405121314381, 0.0031540968182279558,
               0.003155137112507774, 0.0031541531587026255, 0.0031549567150881796, 0.003154214297044292,
               0.0031548332262511993, 0.0031542714749900327, 0.0031547465342764143, 0.003154321375045515]

ex1_sing_obj = [0.00036477348707927994, 0.0003544988431545682, 0.00034719514749023054, 0.00034126560061513065,
                0.0003364372381801361, 0.00033248020474429033, 0.0003292198106659788, 0.0003265208283996693,
                0.00032427643510946205, 0.00032240341750379675, 0.000320835590774419, 0.00031952018280069895,
                0.00031841414151572215, 0.00031748223349302896, 0.00031669537717365237, 0.00031603017127512545,
                0.0003154664623286607, 0.00031498850938890816, 0.00031458343670363485, 0.00031423977410960114,
                0.0003139478300212347, 0.0003136994671706363, 0.00031348809971317907, 0.0003133082468546502,
                0.00031315509359381474, 0.000313024651851131, 0.00031291373186888825, 0.00031281913573673727,
                0.00031273853672843715, 0.0003126697836773807, 0.0003126110730675728, 0.00031256087898209574,
                0.0003125179452229799, 0.0003124811620454702, 0.0003124496634248715, 0.00031242267173327444,
                0.0003123995342567679, 0.0003123796897276772, 0.00031236263332110384, 0.0003123479807145216,
                0.0003123353898090316, 0.0003123245573123151, 0.00031231525092628964, 0.00031230726543314655,
                0.0003123003999752833]

ex2_sing_obj = [0.0005092924972416285, 0.00033026308120982984, 0.00031591022143322015, 0.0003153567539434875,
               0.0003149078400960828, 0.00031455051671706316, 0.0003142625199099122, 0.0003140284238513198,
               0.00031383658791043643, 0.0003136783753324092, 0.00031354713306835474, 0.0003134377293699595,
               0.00031334613926387375, 0.0003132691765196223, 0.00031320429582436027, 0.00031314943716835965,
               0.000313102957120632, 0.00031306352459857626, 0.0003130300271591918, 0.00031300154052141564,
               0.0003129772803677754, 0.00031295659004491574, 0.0003129389185233969]

plt.plot(ex1_int_obj, label='Example 1 (int. kernel)', ls='-', color='b')
plt.plot(ex2_int_obj, label='Example 2 (int. kernel)', ls='--', color='r')

# plt.plot(ex1_sing_obj, label='Example 1 (sing. kernel)', ls='-', color='b')
# plt.plot(ex2_sing_obj, label='Example 2 (sing. kernel)', ls='--', color='r')


# plt.plot(ex1_int_def, label='Example 1 (int. kernel)', ls='-', color='b')
# plt.plot(ex2_int_def, label='Example 2 (int. kernel)', ls='--', color='r')
# plt.plot(ex1_sing_def, label='Example 1 (sing. kernel)', ls='-', color='g')
# plt.plot(ex2_sing_def, label='Example 2 (sing. kernel)', ls='--', color='c')

plt.xlim([0, 30])
plt.xticks(ticks=[2*t for t in range(15)])
plt.xlabel('iteration')
# plt.ylabel('$L^2$ norm of deformation $\mathbf{W}^{k,h}_{\epsilon}$')
plt.ylabel('objective functional value')
plt.yscale('log')
plt.legend()
# plt.savefig('fgs_talk_obj.eps', bbox_inches='tight')
# plt.savefig('comparison_deformation_norms.eps', bbox_inches='tight')
# plt.savefig('comparison_objective_functional_sing.pdf', bbox_inches='tight')
plt.savefig('comparison_objective_functional_int.pdf', bbox_inches='tight')
plt.show(bbox_inches='tight')
